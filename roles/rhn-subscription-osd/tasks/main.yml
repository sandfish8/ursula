---
- name: Register with RHN
  redhat_subscription:
    state: present
    username: "{{ redhat.user }}"
    password: "{{ redhat.pass }}"

- name: Pause for registration
  pause:
    seconds: 90

- name: add pool for OSDs
  command: subscription-manager attach --pool={{ item }}
  with_items:
  - "{{ redhat.osd.pool_id }}"
  failed_when: false

- name: add OSD repositories
  command: subscription-manager repos --enable={{ item }}
  with_items:
  - "{{ redhat.osd.repos }}"
  failed_when: false
